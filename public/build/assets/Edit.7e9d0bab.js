import{u as N,a as q,r as c,bA as T,c as v,w as t,b as _,o as g,d as a,V as j,aN as A,e as E,f as V,g as b,n as $,i as P,j as I,k as e,O as w,Q as y,b9 as F,l as n,au as L,p as O,aE as z}from"./app.75fe97d5.js";import{r as i}from"./rules.e0338894.js";import{V as U}from"./VRow.1decdef7.js";import{V as d}from"./VCol.73001860.js";import{V as H}from"./VAlert.6eca066d.js";import{V as M}from"./VForm.36860c1c.js";import{V as Q}from"./VAutocomplete.e2064418.js";import{V as R}from"./VChip.d1149a3f.js";import{V as S}from"./VSwitch.6870d19e.js";import{V as G}from"./VContainer.5696422c.js";/* empty css              */import"./VSelect.0dade002.js";import"./VCheckboxBtn.47b8d0ed.js";import"./VSelectionControl.7a610615.js";const J={class:"text-error"},de={__name:"Edit",props:{customers:{type:Object,default:null},school:{type:Object,default:null}},setup(k){const u=k,B=N(),l=q({_method:"PUT",customer:u.school.customer_id,name:u.school.name,domain:u.school.domain,host:u.school.host,port:u.school.port,username:u.school.username,password:u.school.password,database:u.school.database,is_active:!!u.school.is_active,create_new_database:!1});function C(){l.post(route("admin.schools.update",{school:u.school.id}),{onSuccess:r=>{B.showNotification(r)}})}const p=c(null),f=c(!1),h=c([...u.customers.map(r=>({value:r.id,name:r.name,avatar:r.avatar}))]);return T(()=>{if(p.value){if(f.value)return;f.value=!0,setTimeout(()=>{z.Inertia.visit(route("admin.schools.edit",{school:u.school.id}),{preserveState:!0,preserveScroll:!0,only:["customers"],headers:{search:p.value},onSuccess:r=>{h.value=[...r.props.customers.map(s=>({value:s.id,name:s.name,avatar:s.avatar}))]}})},500),f.value=!1}}),(r,s)=>{const D=_("AppLayout");return g(),v(D,{title:r.$t("Edit School"),back:r.route("admin.schools.index")},{default:t(()=>[a(G,null,{default:t(()=>[a(U,{justify:"center"},{default:t(()=>[a(d,{cols:"12",md:"8"},{default:t(()=>[a(j,null,{default:t(()=>[a(A,null,{default:t(()=>[a(E,null,{default:t(()=>[V(b(r.$t("Edit School")),1)]),_:1}),a(H,{title:r.$t("Be careful"),variant:"outlined",type:"warning",prominent:"",border:"top",class:"d-flex justify-space-between mt-3"},{default:t(()=>[V(b(r.$t("Backup your database before updating.  The database may corrupt during modification."))+" ",1),a($,{color:"primary",text:"",onClick:s[0]||(s[0]=o=>r.$inertia.visit(r.route("admin.settings.backups.index")))},{default:t(()=>[V(" Backup now ")]),_:1})]),_:1},8,["title"])]),_:1}),a(P,null,{default:t(()=>[a(M,{onSubmit:I(C,["prevent"])},{default:t(()=>[a(U,null,{default:t(()=>[a(d,{cols:"12"},{default:t(()=>[a(Q,{modelValue:e(l).customer,"onUpdate:modelValue":s[1]||(s[1]=o=>e(l).customer=o),search:p.value,"onUpdate:search":s[2]||(s[2]=o=>p.value=o),disabled:f.value,items:h.value,filled:"",chips:"","closable-chips":"",label:r.$t("Select Customer"),"item-title":"name","item-value":"value"},{chip:t(({props:o,item:m})=>[a(R,w(o,{"prepend-avatar":m.raw.avatar,text:m.raw.name,value:m.raw.value}),null,16,["prepend-avatar","text","value"])]),item:t(({props:o,item:m})=>[typeof m.raw!="object"?(g(),v(y,F(w({key:0},o)),null,16)):(g(),v(y,w({key:1},o,{"prepend-avatar":m.raw.avatar,title:m.raw.name,value:m.raw.value}),null,16,["prepend-avatar","title","value"]))]),_:1},8,["modelValue","search","disabled","items","label"])]),_:1}),a(d,{cols:"12"},{default:t(()=>[a(n,{modelValue:e(l).name,"onUpdate:modelValue":s[3]||(s[3]=o=>e(l).name=o),label:r.$t("School Name"),rules:[e(i).required],"error-messages":e(l).errors.name},null,8,["modelValue","label","rules","error-messages"])]),_:1}),a(d,{cols:"12"},{default:t(()=>[a(n,{modelValue:e(l).domain,"onUpdate:modelValue":s[4]||(s[4]=o=>e(l).domain=o),label:r.$t("Domain"),rules:[e(i).required],"error-messages":e(l).errors.domain,hint:"example: school.com or school.example.com"},null,8,["modelValue","label","rules","error-messages"])]),_:1}),a(d,{cols:"12"},{default:t(()=>[a(n,{modelValue:e(l).host,"onUpdate:modelValue":s[5]||(s[5]=o=>e(l).host=o),label:r.$t("DB Host"),rules:[e(i).required],"error-messages":e(l).errors.host},null,8,["modelValue","label","rules","error-messages"])]),_:1}),a(d,{cols:"12"},{default:t(()=>[a(n,{modelValue:e(l).port,"onUpdate:modelValue":s[6]||(s[6]=o=>e(l).port=o),label:r.$t("DB Port"),rules:[e(i).required],"error-messages":e(l).errors.port},null,8,["modelValue","label","rules","error-messages"])]),_:1}),a(d,{cols:"12"},{default:t(()=>[a(n,{modelValue:e(l).username,"onUpdate:modelValue":s[7]||(s[7]=o=>e(l).username=o),label:r.$t("DB Username"),rules:[e(i).required],"error-messages":e(l).errors.username},null,8,["modelValue","label","rules","error-messages"])]),_:1}),a(d,{cols:"12"},{default:t(()=>[a(n,{modelValue:e(l).password,"onUpdate:modelValue":s[8]||(s[8]=o=>e(l).password=o),label:r.$t("DB Password"),rules:[e(i).required],"error-messages":e(l).errors.password},null,8,["modelValue","label","rules","error-messages"])]),_:1}),a(d,{cols:"12"},{default:t(()=>[a(n,{modelValue:e(l).database,"onUpdate:modelValue":s[9]||(s[9]=o=>e(l).database=o),label:r.$t("DB Database"),rules:[e(i).required],"error-messages":e(l).errors.database},null,8,["modelValue","label","rules","error-messages"])]),_:1}),a(d,{cols:"12"},{default:t(()=>[a(S,{modelValue:e(l).is_active,"onUpdate:modelValue":s[10]||(s[10]=o=>e(l).is_active=o),label:r.$t("Active"),"error-messages":e(l).errors.is_active},null,8,["modelValue","label","error-messages"])]),_:1}),a(d,{cols:"12"},{default:t(()=>[a(S,{modelValue:e(l).create_new_database,"onUpdate:modelValue":s[11]||(s[11]=o=>e(l).create_new_database=o),label:r.$t("Create New Database"),"error-messages":e(l).errors.create_new_database},null,8,["modelValue","label","error-messages"]),L("p",J,b(r.$t("NB: Existing database will be dropped")),1)]),_:1}),a(d,{cols:"12"},{default:t(()=>[a($,{class:"d-md-block",type:"submit",loading:e(l).processing},{default:t(()=>[a(O,{icon:"mdi-content-save"}),V(" "+b(r.$t("Update")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["title","back"])}}};export{de as default};
